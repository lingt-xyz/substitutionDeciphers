package decrypt

import (
	"fmt"
	"math"
	"sort"
	"strings"
)

type LetterFrequency struct {
	letter    byte
	frequency float64
}

// English letter frequency
var LetterFrequencyFactArray = []LetterFrequency{
	{'E', 12.49},
	{'T', 9.28},
	{'A', 8.04},
	{'O', 7.64},
	{'I', 7.57},
	{'N', 7.23},
	{'S', 6.51},
	{'R', 6.28},
	{'H', 5.05},
	{'L', 4.07},
	{'D', 3.82},
	{'C', 3.34},
	{'U', 2.73},
	{'M', 2.51},
	{'F', 2.40},
	{'P', 2.14},
	{'G', 1.87},
	{'W', 1.68},
	{'Y', 1.66},
	{'B', 1.48},
	{'V', 1.05},
	{'K', 0.54},
	{'X', 0.23},
	{'J', 0.16},
	{'Q', 0.12},
	{'Z', 0.09},
}

// FindIndex finds the index of the given letter in the english letter frequency array.
func FindIndex(letter byte) int {
	for i, v := range LetterFrequencyFactArray {
		if letter == v.letter {
			return i
		}
	}
	return -1
}

type TwoLettersFrequency struct {
	letters   string
	frequency float64
}

// biGramFactArray is the raw data.
// It should not be used in the program; instead, use `BiGramFactMatrixByFrequency`.
var biGramFactArray = []TwoLettersFrequency{
	{"TH", 0.03556203387},
	{"HE", 0.03074741243},
	{"IN", 0.0243274529},
	{"ER", 0.02048264813},
	{"AN", 0.01985151079},
	{"RE", 0.01854323191},
	{"ON", 0.01758046423},
	{"AT", 0.01486732301},
	{"EN", 0.01454248456},
	{"ND", 0.01352281446},
	{"TI", 0.01342578817},
	{"ES", 0.01339393751},
	{"OR", 0.01276539062},
	{"TE", 0.01204869634},
	{"OF", 0.01174975281},
	{"ED", 0.01168123365},
	{"IS", 0.01128429883},
	{"IT", 0.01123273736},
	{"AL", 0.01087449529},
	{"AR", 0.01074898474},
	{"ST", 0.01053475658},
	{"TO", 0.0104126653},
	{"NT", 0.01041251151},
	{"NG", 0.009530148421},
	{"SE", 0.009321145793},
	{"HA", 0.009257635592},
	{"AS", 0.008710950726},
	{"OU", 0.008700023194},
	{"IO", 0.008349318508},
	{"LE", 0.008292542349},
	{"VE", 0.00825280566},
	{"CO", 0.007938597245},
	{"ME", 0.007930064859},
	{"DE", 0.007648183906},
	{"HI", 0.007632418139},
	{"RI", 0.007276188664},
	{"RO", 0.007267244408},
	{"IC", 0.006987074876},
	{"NE", 0.00691722265},
	{"EA", 0.006881652899},
	{"RA", 0.006856330314},
	{"CE", 0.006514173632},
	{"LI", 0.006243521843},
	{"CH", 0.005977659777},
	{"LL", 0.005765710763},
	{"BE", 0.005762837162},
	{"MA", 0.005652693455},
	{"SI", 0.005500572424},
	{"OM", 0.005462568851},
	{"UR", 0.005427477815},
	{"CA", 0.005381640983},
	{"EL", 0.005303015589},
	{"TA", 0.005298860707},
	{"LA", 0.005275294442},
	{"NS", 0.005089374519},
	{"DI", 0.004929664045},
	{"FO", 0.004877535685},
	{"HO", 0.004849020686},
	{"PE", 0.00477989185},
	{"EC", 0.004772827186},
	{"PR", 0.004744709159},
	{"NO", 0.004645749578},
	{"CT", 0.00460971757},
	{"US", 0.004542570592},
	{"AC", 0.004477721996},
	{"OT", 0.004421032982},
	{"IL", 0.004315346176},
	{"TR", 0.004258201782},
	{"LY", 0.00425013516},
	{"NC", 0.004157458431},
	{"ET", 0.004126082418},
	{"UT", 0.004051512682},
	{"SS", 0.004050752089},
	{"SO", 0.003977321584},
	{"RS", 0.003965272774},
	{"UN", 0.003944130464},
	{"LO", 0.003868842},
	{"WA", 0.00385337077},
	{"GE", 0.00385189513},
	{"IE", 0.003846463877},
	{"WH", 0.003787934314},
	{"EE", 0.003776054085},
	{"WI", 0.003744207032},
	{"EM", 0.003736636383},
	{"AD", 0.003679564182},
	{"OL", 0.003654926484},
	{"RT", 0.003616764125},
	{"PO", 0.00361373182},
	{"WE", 0.003608992326},
	{"NA", 0.003472349729},
	{"UL", 0.003458294938},
	{"NI", 0.003392124776},
	{"TS", 0.003374882126},
	{"MO", 0.003368776225},
	{"OW", 0.003304780418},
	{"PA", 0.00323572471},
	{"IM", 0.003177599465},
	{"MI", 0.003176913694},
	{"AI", 0.003164477518},
	{"SH", 0.003152400036},
	{"IR", 0.003151723975},
	{"SU", 0.003111765343},
	{"ID", 0.00295503911},
	{"OS", 0.002899667677},
	{"IV", 0.002878482189},
	{"IA", 0.002862824346},
	{"AM", 0.00284865969},
	{"FI", 0.002845856272},
	{"CI", 0.002814848033},
	{"VI", 0.002695443494},
	{"PL", 0.002629870834},
	{"IG", 0.002549613798},
	{"TU", 0.002549067195},
	{"EV", 0.002547837155},
	{"LD", 0.002526063785},
	{"RY", 0.002477401216},
	{"MP", 0.00239175226},
	{"FE", 0.002365731954},
	{"BL", 0.002334001713},
	{"AB", 0.002297864172},
	{"GH", 0.002275033605},
	{"TY", 0.002272771009},
	{"OP", 0.002239110517},
	{"WO", 0.00221754315},
	{"SA", 0.002180174457},
	{"AY", 0.00217360835},
	{"EX", 0.002140445903},
	{"KE", 0.002137679697},
	{"FR", 0.002131886148},
	{"OO", 0.002102592171},
	{"AV", 0.002049326471},
	{"AG", 0.002047249065},
	{"IF", 0.002032565155},
	{"AP", 0.002028459082},
	{"GR", 0.001967778661},
	{"OD", 0.001954494292},
	{"BO", 0.001954105308},
	{"SP", 0.001912542211},
	{"RD", 0.001893163849},
	{"DO", 0.001882349711},
	{"UC", 0.001876522622},
	{"BU", 0.001849441939},
	{"EI", 0.001833516542},
	{"OV", 0.00178086545},
	{"BY", 0.001764684295},
	{"RM", 0.001751329245},
	{"EP", 0.00171573739},
	{"TT", 0.001706833027},
	{"OC", 0.001664050858},
	{"FA", 0.001639997854},
	{"EF", 0.00162732115},
	{"CU", 0.00162613977},
	{"RN", 0.001603610511},
	{"SC", 0.001547493794},
	{"GI", 0.001516365615},
	{"DA", 0.001510673639},
	{"YO", 0.001499016101},
	{"CR", 0.001494558306},
	{"CL", 0.001490113512},
	{"DU", 0.00148460771},
	{"GA", 0.00148077067},
	{"QU", 0.001475413257},
	{"UE", 0.001474803472},
	{"FF", 0.001463165786},
	{"BA", 0.00146204465},
	{"EY", 0.001437457264},
	{"LS", 0.001415134913},
	{"VA", 0.001399800745},
	{"UM", 0.001383826156},
	{"PP", 0.001365455984},
	{"UA", 0.00136333253},
	{"UP", 0.001360124829},
	{"LU", 0.001351893577},
	{"GO", 0.001321278082},
	{"HT", 0.001301858762},
	{"RU", 0.001283287569},
	{"UG", 0.001279075757},
	{"DS", 0.00126260675},
	{"LT", 0.001236370993},
	{"PI", 0.001230941048},
	{"RC", 0.001213866405},
	{"RR", 0.001207430548},
	{"EG", 0.001195361338},
	{"AU", 0.001190327743},
	{"CK", 0.001176261243},
	{"EW", 0.001168057799},
	{"MU", 0.001146185326},
	{"BR", 0.001115598518},
	{"BI", 0.001065971186},
	{"PT", 0.001057821336},
	{"AK", 0.001046993203},
	{"PU", 0.001045402051},
	{"UI", 0.001011533127},
	{"RG", 0.0009977345013},
	{"IB", 0.000986028683},
	{"TL", 0.0009844918163},
	{"NY", 0.0009791744505},
	{"KI", 0.0009787843031},
	{"RK", 0.0009703434723},
	{"YS", 0.0009683226243},
	{"OB", 0.0009667081767},
	{"MM", 0.0009606901207},
	{"FU", 0.0009597491047},
	{"PH", 0.0009439001974},
	{"OG", 0.0009402421034},
	{"MS", 0.0009283316556},
	{"YE", 0.0009266857606},
	{"UD", 0.0009140148635},
	{"MB", 0.0009025552218},
	{"IP", 0.0008921120651},
	{"UB", 0.0008858033354},
	{"OI", 0.0008775074677},
	{"RL", 0.0008626468396},
	{"GU", 0.0008576950869},
	{"DR", 0.0008544990499},
	{"HR", 0.0008439253556},
	{"CC", 0.0008313828515},
	{"TW", 0.0008237223232},
	{"FT", 0.0008166436439},
	{"WN", 0.0007898759689},
	{"NU", 0.0007864445487},
	{"AF", 0.0007420729464},
	{"HU", 0.0007369276171},
	{"NN", 0.000727646949},
	{"EO", 0.0007250045774},
	{"VO", 0.0007110718486},
	{"RV", 0.000692833068},
	{"NF", 0.0006718072827},
	{"XP", 0.0006686383212},
	{"GN", 0.0006563910133},
	{"SM", 0.0006519902425},
	{"FL", 0.0006490488182},
	{"IZ", 0.0006433975365},
	{"OK", 0.0006431180495},
	{"NL", 0.0006378390695},
	{"MY", 0.0006218641334},
	{"GL", 0.0006063676261},
	{"AW", 0.0005991626391},
	{"JU", 0.0005870242887},
	{"OA", 0.0005748606632},
	{"EQ", 0.0005725195733},
	{"SY", 0.0005684471397},
	{"SL", 0.0005588067999},
	{"PS", 0.0005457118645},
	{"JO", 0.0005378966907},
	{"LF", 0.0005347688516},
	{"NV", 0.0005200714831},
	{"JE", 0.0005188748751},
	{"NK", 0.0005160546486},
	{"KN", 0.0005143883089},
	{"GS", 0.0005119317273},
	{"DY", 0.0005042273931},
	{"HY", 0.0005008908999},
	{"ZE", 0.0004973256335},
	{"KS", 0.0004750889701},
	{"XT", 0.0004666052494},
	{"BS", 0.0004583240413},
	{"IK", 0.0004291274372},
	{"DD", 0.0004275145423},
	{"CY", 0.0004171861457},
	{"RP", 0.000416199437},
	{"SK", 0.0003946469241},
	{"XI", 0.0003941831666},
	{"OE", 0.0003863066518},
	{"OY", 0.0003618128391},
	{"WS", 0.0003508411199},
	{"LV", 0.0003490591289},
	{"DL", 0.000323402665},
	{"RF", 0.0003226041508},
	{"EU", 0.0003115273474},
	{"DG", 0.0003100328773},
	{"WR", 0.0003076116027},
	{"XA", 0.0002960104891},
	{"YI", 0.000288197255},
	{"NM", 0.000277494857},
	{"EB", 0.0002707357514},
	{"RB", 0.0002671222439},
	{"TM", 0.0002647908857},
	{"XC", 0.0002645976953},
	{"EH", 0.0002632371659},
	{"TC", 0.0002613628245},
	{"GY", 0.0002593998157},
	{"JA", 0.0002586149098},
	{"HN", 0.0002575797726},
	{"YP", 0.0002491432423},
	{"ZA", 0.0002490366161},
	{"GG", 0.0002475473061},
	{"YM", 0.0002367488211},
	{"SW", 0.0002352820131},
	{"BJ", 0.0002322451557},
	{"LM", 0.0002302091939},
	{"CS", 0.00022822967},
	{"II", 0.0002278229923},
	{"IX", 0.0002203199194},
	{"XE", 0.0002179456032},
	{"OH", 0.0002135437149},
	{"LK", 0.0001971452016},
	{"DV", 0.0001905269703},
	{"LP", 0.000190304866},
	{"AX", 0.0001883937858},
	{"OX", 0.0001857541269},
	{"UF", 0.0001853228151},
	{"DM", 0.0001817673698},
	{"IU", 0.0001740899395},
	{"SF", 0.0001716446099},
	{"BT", 0.0001710392216},
	{"KA", 0.0001695576569},
	{"YT", 0.0001668390461},
	{"EK", 0.0001647180223},
	{"PM", 0.0001595616356},
	{"YA", 0.0001576581644},
	{"GT", 0.0001540263965},
	{"WL", 0.0001522117519},
	{"RH", 0.0001511158078},
	{"YL", 0.0001475645594},
	{"HS", 0.0001468417088},
	{"AH", 0.0001364329492},
	{"YC", 0.0001350056711},
	{"YN", 0.0001321417964},
	{"RW", 0.0001275736205},
	{"HM", 0.0001274324149},
	{"LW", 0.0001263889136},
	{"HL", 0.0001259191748},
	{"AE", 0.0001239651972},
	{"ZI", 0.0001211744834},
	{"AZ", 0.0001186912922},
	{"LC", 0.0001182191142},
	{"PY", 0.0001176375237},
	{"AJ", 0.0001175263033},
	{"IQ", 0.0001130375936},
	{"NJ", 0.00011086396},
	{"BB", 0.0001093310462},
	{"NH", 0.0001088371124},
	{"UO", 0.0001065674013},
	{"KL", 0.0001056981974},
	{"LR", 0.0001005126849},
	{"TN", 0.0001001065175},
	{"GM", 0.00009858149369},
	{"SN", 0.00009174955952},
	{"NR", 0.00009151747362},
	{"FY", 0.00009098073818},
	{"MN", 0.00008790070008},
	{"DW", 0.00008162407912},
	{"SB", 0.00007916276819},
	{"YR", 0.00007791586451},
	{"DN", 0.00007569403327},
	{"SQ", 0.00007443946555},
	{"ZO", 0.0000718101849},
	{"OJ", 0.0000697589276},
	{"YD", 0.00006818024879},
	{"LB", 0.00006690295672},
	{"WT", 0.00006541432485},
	{"LG", 0.00006087869252},
	{"KO", 0.00006076079687},
	{"NP", 0.00006035706137},
	{"SR", 0.00005989948006},
	{"NQ", 0.00005950012913},
	{"KY", 0.00005949708692},
	{"LN", 0.00005869835739},
	{"NW", 0.00005797005116},
	{"TF", 0.0000566119466},
	{"FS", 0.00005509522094},
	{"CQ", 0.00005474539117},
	{"DH", 0.00005438395966},
	{"SD", 0.00005258615288},
	{"VY", 0.00004897224175},
	{"DJ", 0.00004781874391},
	{"HW", 0.00004774158646},
	{"XU", 0.00004771072568},
	{"AO", 0.00004626167371},
	{"ML", 0.00004606537826},
	{"UK", 0.00004604092995},
	{"UY", 0.00004567302107},
	{"EJ", 0.00004546450784},
	{"EZ", 0.00004523242832},
	{"HB", 0.00004389827449},
	{"NZ", 0.00004369066102},
	{"NB", 0.00004335938098},
	{"MC", 0.00004312266403},
	{"YB", 0.00004299121179},
	{"TP", 0.00004294463459},
	{"XH", 0.00004171373389},
	{"UX", 0.00003934788366},
	{"TZ", 0.00003848954487},
	{"BV", 0.0000384390172},
	{"MF", 0.00003818344693},
	{"WD", 0.0000353827628},
	{"OZ", 0.0000347222349},
	{"YW", 0.00003371689165},
	{"KH", 0.00003185186372},
	{"GD", 0.00003159517026},
	{"BM", 0.00003129052072},
	{"MR", 0.00003106055847},
	{"KU", 0.00003025675245},
	{"UV", 0.00002917098789},
	{"DT", 0.00002895677114},
	{"HD", 0.00002856522929},
	{"AA", 0.00002829940709},
	{"XX", 0.00002804173763},
	{"DF", 0.00002778612055},
	{"DB", 0.00002773035182},
	{"JI", 0.00002762737462},
	{"KR", 0.00002721722345},
	{"XO", 0.00002698804322},
	{"CM", 0.00002665030461},
	{"ZZ", 0.00002660339156},
	{"NX", 0.00002620865677},
	{"YG", 0.00002592595844},
	{"XY", 0.00002576401532},
	{"KG", 0.00002562990496},
	{"TB", 0.00002544494526},
	{"DC", 0.00002519098227},
	{"BD", 0.00002474095967},
	{"SG", 0.00002467978924},
	{"WY", 0.00002424720844},
	{"ZY", 0.00002357487097},
	{"AQ", 0.00002244381163},
	{"HF", 0.00002243173288},
	{"CD", 0.00002230972752},
	{"VU", 0.00002212495968},
	{"KW", 0.00002178151827},
	{"ZU", 0.00002152485922},
	{"BN", 0.00002094651915},
	{"IH", 0.00002091255126},
	{"TG", 0.00001969131767},
	{"XV", 0.00001953308527},
	{"UZ", 0.00001910646973},
	{"BC", 0.00001889520086},
	{"XF", 0.00001857464587},
	{"YZ", 0.00001812200806},
	{"KM", 0.00001789193339},
	{"DP", 0.00001732676582},
	{"LH", 0.00001618740549},
	{"WF", 0.00001607658551},
	{"KF", 0.00001587409924},
	{"PF", 0.00001454864113},
	{"CF", 0.00001408122639},
	{"MT", 0.00001366784292},
	{"YU", 0.00001327684795},
	{"CP", 0.00001314604791},
	{"PB", 0.00001308720116},
	{"TD", 0.00001295882234},
	{"ZL", 0.0000125748548},
	{"SV", 0.00001241460657},
	{"HC", 0.00001228216024},
	{"MG", 0.00001224863566},
	{"PW", 0.00001207146448},
	{"GF", 0.00001204489251},
	{"PD", 0.00001198667278},
	{"PN", 0.00001189366627},
	{"PC", 0.00001175908883},
	{"RX", 0.00001170019775},
	{"TV", 0.00001163463601},
	{"IJ", 0.00001110929448},
	{"WM", 0.00001089925767},
	{"UH", 0.00001067402578},
	{"WK", 0.00001067352182},
	{"WB", 0.00001061442964},
	{"BH", 0.00001056790671},
	{"OQ", 0.00001036565699},
	{"KT", 0.0000103317955},
	{"RQ", 0.000009984375595},
	{"KB", 0.000009010369431},
	{"CG", 0.000008857680609},
	{"VR", 0.000008760351597},
	{"CN", 0.000008600191669},
	{"PK", 0.000008192278008},
	{"UU", 0.000007804796576},
	{"YF", 0.000007535169305},
	{"WP", 0.000007441508817},
	{"CZ", 0.000007306441251},
	{"KP", 0.00000726777599},
	{"DQ", 0.000007067476156},
	{"WU", 0.000006951773316},
	{"FM", 0.000006859251262},
	{"WC", 0.00000674132156},
	{"MD", 0.000006713220683},
	{"KD", 0.000006701069939},
	{"ZH", 0.000006661331855},
	{"GW", 0.000006476265049},
	{"RZ", 0.00000638130476},
	{"CB", 0.0000062957651},
	{"IW", 0.000006246125832},
	{"XL", 0.000005932714958},
	{"HP", 0.000005921321043},
	{"MW", 0.000005839477215},
	{"VS", 0.000005767798788},
	{"FC", 0.000005764657277},
	{"RJ", 0.000005531870227},
	{"BP", 0.00000547131015},
	{"MH", 0.000005331806947},
	{"HH", 0.00000522417954},
	{"YH", 0.000005207320078},
	{"UJ", 0.000005159490601},
	{"FG", 0.000005115691038},
	{"FD", 0.000004953369504},
	{"GB", 0.000004945574246},
	{"PG", 0.000004736364837},
	{"TK", 0.000004639558582},
	{"KK", 0.000004533401564},
	{"HQ", 0.000004229354221},
	{"FN", 0.000004193077898},
	{"LZ", 0.000004173474136},
	{"VL", 0.000004121421459},
	{"GP", 0.000004118557642},
	{"HZ", 0.000003805413111},
	{"DK", 0.000003367078792},
	{"YK", 0.000003295636562},
	{"QI", 0.000003175775778},
	{"LX", 0.000003054429711},
	{"VD", 0.000002989836882},
	{"ZS", 0.000002977626912},
	{"BW", 0.000002950660922},
	{"XQ", 0.000002917205503},
	{"MV", 0.000002898408575},
	{"UW", 0.00000277497857},
	{"HG", 0.000002762652274},
	{"FB", 0.000002741761124},
	{"SJ", 0.000002703105793},
	{"WW", 0.000002616489764},
	{"GK", 0.000002602755853},
	{"UQ", 0.000002566167436},
	{"BG", 0.000002554651165},
	{"SZ", 0.000002497125494},
	{"JR", 0.000002428154837},
	{"QL", 0.000002379333752},
	{"ZT", 0.000002350404761},
	{"HK", 0.000002339148451},
	{"VC", 0.000002330365486},
	{"XM", 0.000002329789885},
	{"GC", 0.000002289304194},
	{"FW", 0.000002288043405},
	{"PZ", 0.000002263462097},
	{"KC", 0.000002243538439},
	{"HV", 0.0000022318264},
	{"XW", 0.000002231658649},
	{"ZW", 0.000002226963407},
	{"FP", 0.000002221150301},
	{"IY", 0.000002215721638},
	{"PV", 0.000002206680841},
	{"VT", 0.000002192436584},
	{"JP", 0.000002173822657},
	{"CV", 0.000002081598865},
	{"ZB", 0.000002077628178},
	{"VP", 0.000001954150649},
	{"ZR", 0.000001886934103},
	{"FH", 0.000001832192452},
	{"YV", 0.000001814317265},
	{"ZG", 0.000001676318497},
	{"ZM", 0.000001671692057},
	{"ZV", 0.000001638034487},
	{"QS", 0.000001577707062},
	{"KV", 0.000001565775848},
	{"VN", 0.000001531307898},
	{"ZN", 0.000001525190145},
	{"QA", 0.00000152439998},
	{"YX", 0.000001493509053},
	{"JN", 0.000001472122099},
	{"BF", 0.000001457158607},
	{"MK", 0.000001403317773},
	{"CW", 0.000001386415043},
	{"JM", 0.000001297864386},
	{"LQ", 0.000001270694471},
	{"JH", 0.000001256132091},
	{"KJ", 0.000001231055689},
	{"JC", 0.000001222689086},
	{"GZ", 0.000001216880945},
	{"JS", 0.000001180651082},
	{"TX", 0.00000118060143},
	{"FK", 0.000001167943889},
	{"JL", 0.000001132166207},
	{"VM", 0.00000112716419},
	{"LJ", 0.000001124188657},
	{"TJ", 0.000001124126593},
	{"JJ", 0.000001056846209},
	{"CJ", 0.000001050497223},
	{"VG", 0.000001049865942},
	{"MJ", 0.000001036764021},
	{"JT", 0.0000010348223},
	{"PJ", 0.000000996847192},
	{"WG", 0.0000009759262511},
	{"VH", 0.0000009543970815},
	{"BK", 0.0000009361016317},
	{"VV", 0.0000009301009143},
	{"JD", 0.0000009274679754},
	{"TQ", 0.0000008928017742},
	{"VB", 0.0000008852171795},
	{"JF", 0.0000008588913371},
	{"DZ", 0.0000007804848001},
	{"XB", 0.0000007677244092},
	{"JB", 0.0000007540316375},
	{"ZC", 0.0000007450525498},
	{"FJ", 0.0000007325116888},
	{"YY", 0.0000007068281217},
	{"QN", 0.0000006595859489},
	{"XS", 0.0000006400552451},
	{"QR", 0.0000006186289246},
	{"JK", 0.000000617142222},
	{"JV", 0.0000006099048319},
	{"QQ", 0.0000006072424569},
	{"XN", 0.0000005722709},
	{"VF", 0.0000005498235355},
	{"PX", 0.0000005225688586},
	{"ZD", 0.0000005018387206},
	{"QT", 0.0000004913725757},
	{"ZP", 0.0000004829818563},
	{"QO", 0.000000469688423},
	{"DX", 0.0000004597276577},
	{"HJ", 0.0000004547955077},
	{"GV", 0.0000004228753795},
	{"JW", 0.0000004134941161},
	{"QC", 0.0000003998346816},
	{"JY", 0.0000003972889872},
	{"GJ", 0.0000003876449264},
	{"QB", 0.0000003842455838},
	{"PQ", 0.0000003812686321},
	{"JG", 0.0000003670296958},
	{"BZ", 0.0000003572675357},
	{"MX", 0.0000003526428694},
	{"QM", 0.0000003510589921},
	{"MZ", 0.0000003441127715},
	{"QF", 0.0000003361674954},
	{"WJ", 0.0000003242157119},
	{"ZQ", 0.0000003238103443},
	{"XR", 0.0000003218147156},
	{"ZK", 0.0000003215054588},
	{"CX", 0.0000003109364647},
	{"FX", 0.0000002880188312},
	{"FV", 0.0000002863097616},
	{"BX", 0.0000002761401061},
	{"VW", 0.0000002632187031},
	{"VJ", 0.0000002568995079},
	{"MQ", 0.0000002512442218},
	{"QV", 0.0000002253865205},
	{"ZF", 0.0000002157665761},
	{"QE", 0.0000002030182434},
	{"YJ", 0.0000001990784107},
	{"GX", 0.0000001975519871},
	{"KX", 0.0000001969817061},
	{"XG", 0.000000192415912},
	{"QD", 0.0000001843911938},
	{"XJ", 0.0000001812535846},
	{"SX", 0.0000001786639133},
	{"VZ", 0.0000001777478464},
	{"VX	", 0.000000159541769},
	{"WV", 0.0000001380033784},
	{"YQ", 0.0000001364992979},
	{"BQ", 0.0000001228891601},
	{"GQ", 0.0000001225763567},
	{"VK", 0.0000001197111205},
	{"ZJ", 0.0000001095978547},
	{"XK", 0.00000009974774092},
	{"QP", 0.00000009652927103},
	{"HX", 0.00000009362715102},
	{"FZ", 0.00000009357856365},
	{"QH", 0.00000009345408068},
	{"QJ", 0.00000008402706711},
	{"JZ", 0.0000000782629028},
	{"VQ", 0.00000007548987624},
	{"KQ", 0.00000006640581147},
	{"XD", 0.00000005967486491},
	{"QW", 0.00000005791188818},
	{"JX", 0.00000005736501429},
	{"QX", 0.00000005656881981},
	{"KZ", 0.00000005346738519},
	{"WX", 0.00000005342376295},
	{"FQ", 0.00000005299569759},
	{"XZ", 0.00000004841749067},
	{"ZX", 0.0000000383818937},
}

// ConvertBiCountingToBiGram converts the 2-letter counting to a 2-letter biGram.
func ConvertBiCountingToBiGram(biCounting []TwoLettersFrequency) [26][26]float64 {
	matrix := [26][26]float64{}
	for _, v := range biCounting {
		letters := strings.TrimSpace(v.letters)
		column := letters[0] - 'A'
		row := letters[1] - 'A'
		matrix[row][column] = v.frequency
	}
	return matrix
}

// Deprecated: this matrix consider the key space containing whitespace
// BiGramFactMatrixByFrequency is a 2-dimensional array that stores the percentage of 2-letters counting
var BiGramFactMatrixWithSpace = [26][26]float64{
	{0.0028, 0.1462, 0.5382, 0.1511, 0.6882, 0.164, 0.1481, 0.9258, 0.2863, 0.0259, 0.017, 0.5275, 0.5653, 0.3472, 0.0575, 0.3236, 0.0002, 0.6856, 0.218, 0.5299, 0.1363, 0.14, 0.3853, 0.0296, 0.0158, 0.0249},
	{0.2298, 0.0109, 0.0006, 0.0028, 0.0271, 0.0003, 0.0005, 0.0044, 0.0986, 0.0001, 0.0009, 0.0067, 0.0903, 0.0043, 0.0967, 0.0013, 0, 0.0267, 0.0079, 0.0025, 0.0886, 0.0001, 0.0011, 0.0001, 0.0043, 0.0002},
	{0.4478, 0.0019, 0.0831, 0.0025, 0.4773, 0.0006, 0.0002, 0.0012, 0.6987, 0.0001, 0.0002, 0.0118, 0.0043, 0.4157, 0.1664, 0.0012, 0, 0.1214, 0.1547, 0.0261, 0.1877, 0.0002, 0.0007, 0.0265, 0.0135, 0.0001},
	{0.368, 0.0025, 0.0022, 0.0428, 1.1681, 0.0005, 0.0032, 0.0029, 0.2955, 0.0001, 0.0007, 0.2526, 0.0007, 1.3523, 0.1954, 0.0012, 0, 0.1893, 0.0053, 0.0013, 0.0914, 0.0003, 0.0035, 0, 0.0068, 0.0001},
	{0.0124, 0.5763, 0.6514, 0.7648, 0.3776, 0.2366, 0.3852, 3.0747, 0.3846, 0.0519, 0.2138, 0.8293, 0.793, 0.6917, 0.0386, 0.478, 0, 1.8543, 0.9321, 1.2049, 0.1475, 0.8253, 0.3609, 0.0218, 0.0927, 0.0497},
	{0.0742, 0.0001, 0.0014, 0.0028, 0.1627, 0.1463, 0.0012, 0.0022, 0.2033, 0.0001, 0.0016, 0.0535, 0.0038, 0.0672, 1.175, 0.0015, 0, 0.0323, 0.0172, 0.0057, 0.0185, 0.0001, 0.0016, 0.0019, 0.0008, 0},
	{0.2047, 0.0003, 0.0009, 0.031, 0.1195, 0.0005, 0.0248, 0.0003, 0.255, 0, 0.0026, 0.0061, 0.0012, 0.953, 0.094, 0.0005, 0, 0.0998, 0.0025, 0.002, 0.1279, 0.0001, 0.0001, 0, 0.0026, 0.0002},
	{0.0136, 0.0011, 0.5978, 0.0054, 0.0263, 0.0002, 0.2275, 0.0005, 0.0021, 0.0001, 0.0032, 0.0016, 0.0005, 0.0109, 0.0214, 0.0944, 0, 0.0151, 0.3152, 3.5562, 0.0011, 0.0001, 0.3788, 0.0042, 0.0005, 0.0007},
	{0.3164, 0.1066, 0.2815, 0.493, 0.1834, 0.2846, 0.1516, 0.7632, 0.0228, 0.0028, 0.0979, 0.6244, 0.3177, 0.3392, 0.0878, 0.1231, 0.0003, 0.7276, 0.5501, 1.3426, 0.1012, 0.2695, 0.3744, 0.0394, 0.0288, 0.0121},
	{0.0118, 0.0232, 0.0001, 0.0048, 0.0045, 0.0001, 0, 0, 0.0011, 0.0001, 0.0001, 0.0001, 0.0001, 0.0111, 0.007, 0.0001, 0, 0.0006, 0.0003, 0.0001, 0.0005, 0, 0, 0, 0, 0},
	{0.1047, 0.0001, 0.1176, 0.0003, 0.0165, 0.0001, 0.0003, 0.0002, 0.0429, 0.0001, 0.0005, 0.0197, 0.0001, 0.0516, 0.0643, 0.0008, 0, 0.097, 0.0395, 0.0005, 0.0046, 0, 0.0011, 0, 0.0003, 0},
	{1.0874, 0.2334, 0.149, 0.0323, 0.5303, 0.0649, 0.0606, 0.0126, 0.4315, 0.0001, 0.0106, 0.5766, 0.0046, 0.0638, 0.3655, 0.263, 0.0002, 0.0863, 0.0559, 0.0984, 0.3458, 0.0004, 0.0152, 0.0006, 0.0148, 0.0013},
	{0.2849, 0.0031, 0.0027, 0.0182, 0.3737, 0.0007, 0.0099, 0.0127, 0.3178, 0.0001, 0.0018, 0.023, 0.0961, 0.0277, 0.5463, 0.016, 0, 0.1751, 0.0652, 0.0265, 0.1384, 0.0001, 0.0011, 0.0002, 0.0237, 0.0002},
	{1.9852, 0.0021, 0.0009, 0.0076, 1.4542, 0.0004, 0.0656, 0.0258, 2.4327, 0.0001, 0.0514, 0.0059, 0.0088, 0.0728, 1.758, 0.0012, 0.0001, 0.1604, 0.0092, 0.01, 0.3944, 0.0002, 0.079, 0.0001, 0.0132, 0.0002},
	{0.0046, 0.1954, 0.7939, 0.1882, 0.0725, 0.4878, 0.1321, 0.4849, 0.8349, 0.0538, 0.0061, 0.3869, 0.3369, 0.4646, 0.2103, 0.3614, 0, 0.7267, 0.3977, 1.0413, 0.0107, 0.0711, 0.2218, 0.0027, 0.1499, 0.0072},
	{0.2028, 0.0005, 0.0013, 0.0017, 0.1716, 0.0002, 0.0004, 0.0006, 0.0892, 0.0002, 0.0007, 0.019, 0.2392, 0.006, 0.2239, 0.1365, 0, 0.0416, 0.1913, 0.0043, 0.136, 0.0002, 0.0007, 0.0669, 0.0249, 0},
	{0.0022, 0, 0.0055, 0.0007, 0.0573, 0, 0, 0.0004, 0.0113, 0, 0, 0.0001, 0, 0.006, 0.001, 0, 0.0001, 0.001, 0.0074, 0.0001, 0.0003, 0, 0, 0.0003, 0, 0},
	{1.0749, 0.1116, 0.1495, 0.0854, 2.0483, 0.2132, 0.1968, 0.0844, 0.3152, 0.0002, 0.0027, 0.0101, 0.0031, 0.0092, 1.2765, 0.4745, 0.0001, 0.1207, 0.006, 0.4258, 0.5427, 0.0009, 0.0308, 0, 0.0078, 0.0002},
	{0.8711, 0.0458, 0.0228, 0.1263, 1.3394, 0.0055, 0.0512, 0.0147, 1.1284, 0.0001, 0.0475, 0.1415, 0.0928, 0.5089, 0.29, 0.0546, 0.0002, 0.3965, 0.4051, 0.3375, 0.4543, 0.0006, 0.0351, 0.0001, 0.0968, 0.0003},
	{1.4867, 0.0171, 0.461, 0.0029, 0.4126, 0.0817, 0.0154, 0.1302, 1.1233, 0.0001, 0.001, 0.1236, 0.0014, 1.0413, 0.4421, 0.1058, 0, 0.3617, 1.0535, 0.1707, 0.4052, 0.0002, 0.0065, 0.0467, 0.0167, 0.0002},
	{0.119, 0.1849, 0.1626, 0.1485, 0.0312, 0.096, 0.0858, 0.0737, 0.0174, 0.0587, 0.003, 0.1352, 0.1146, 0.0786, 0.87, 0.1045, 0.1475, 0.1283, 0.3112, 0.2549, 0.0008, 0.0022, 0.0007, 0.0048, 0.0013, 0.0022},
	{0.2049, 0.0038, 0.0002, 0.0191, 0.2548, 0, 0, 0.0002, 0.2878, 0.0001, 0.0002, 0.0349, 0.0003, 0.052, 0.1781, 0.0002, 0, 0.0693, 0.0012, 0.0012, 0.0029, 0.0001, 0, 0.002, 0.0002, 0.0002},
	{0.0599, 0.0003, 0.0001, 0.0082, 0.1168, 0.0002, 0.0006, 0.0048, 0.0006, 0, 0.0022, 0.0126, 0.0006, 0.0058, 0.3305, 0.0012, 0, 0.0128, 0.0235, 0.0824, 0.0003, 0, 0.0003, 0.0002, 0.0034, 0.0002},
	{0.0188, 0, 0, 0, 0.214, 0, 0, 0, 0.022, 0, 0, 0.0003, 0, 0.0026, 0.0186, 0.0001, 0, 0.0012, 0, 0.0001, 0.0039, 0, 0, 0.0028, 0.0001, 0},
	{0.2174, 0.1765, 0.0417, 0.0504, 0.1437, 0.0091, 0.0259, 0.0501, 0.0002, 0, 0.0059, 0.425, 0.0622, 0.0979, 0.0362, 0.0118, 0, 0.2477, 0.0568, 0.2273, 0.0046, 0.0049, 0.0024, 0.0026, 0.0001, 0.0024},
	{0.0119, 0, 0.0007, 0.0001, 0.0045, 0, 0.0001, 0.0004, 0.0643, 0, 0, 0.0004, 0, 0.0044, 0.0035, 0.0002, 0, 0.0006, 0.0002, 0.0038, 0.0019, 0, 0, 0, 0.0018, 0.0027},
}

// The letters are sorted by alphabet
var BiGramFactMatrixByAlphabet = [26][26]float64{
	{0.0126, 0.1124, 0.3384, 0.4027, 1.0646, 0.2161, 0.2412, 1.3277, 0.12, 0.0231, 0.0444, 0.4476, 0.4804, 0.3972, 0.2048, 0.2239, 0.0001, 0.5002, 0.6233, 0.6301, 0.0646, 0.0787, 0.4431, 0.0111, 0.1598, 0.0052},
	{0.2441, 0.0483, 0.0021, 0.1732, 0.2658, 0.0238, 0.0378, 0.0293, 0.0621, 0, 0.0166, 0.0459, 0.0692, 0.0818, 0.1234, 0.0099, 0, 0.1051, 0.15, 0.1127, 0.0843, 0, 0.017, 0.0003, 0.0713, 0.0004},
	{0.3092, 0.0033, 0.0386, 0.0802, 0.4329, 0.0226, 0.0237, 0.0177, 0.3049, 0, 0.0068, 0.0353, 0.0089, 0.2972, 0.1116, 0.0059, 0, 0.1117, 0.1931, 0.1111, 0.1571, 0, 0.0138, 0.0175, 0.0634, 0},
	{0.3573, 0.0048, 0.002, 0.1062, 1.1071, 0.0165, 0.0192, 0.0131, 0.2496, 0, 0.0057, 0.2733, 0.0071, 1.1867, 0.1881, 0.0056, 0, 0.2238, 0.0637, 0.0589, 0.0656, 0, 0.0133, 0.0002, 0.0574, 0.0002},
	{0.0041, 0.4292, 0.3592, 0.5668, 0.5799, 0.1584, 0.2487, 2.7966, 0.2125, 0.0255, 0.293, 0.8904, 0.6149, 0.5996, 0.0563, 0.3662, 0, 1.2604, 0.7583, 0.7977, 0.1326, 0.603, 0.2889, 0.0123, 0.2046, 0.0301},
	{0.1016, 0.0029, 0.0015, 0.1171, 0.2899, 0.1047, 0.0378, 0.0192, 0.1449, 0, 0.012, 0.0945, 0.0193, 0.0804, 0.7934, 0.009, 0, 0.0605, 0.1208, 0.0855, 0.019, 0, 0.0149, 0.0009, 0.0586, 0.0001},
	{0.1812, 0.0015, 0.0017, 0.0467, 0.1931, 0.0128, 0.0452, 0.0077, 0.2402, 0, 0.0036, 0.0149, 0.0044, 1.0748, 0.0532, 0.002, 0, 0.0589, 0.0435, 0.032, 0.1443, 0, 0.004, 0.0001, 0.0244, 0},
	{0.1142, 0.0069, 0.3951, 0.1584, 0.2748, 0.0729, 0.3645, 0.0528, 0.0239, 0, 0.0174, 0.0431, 0.0298, 0.1387, 0.0904, 0.0464, 0, 0.0887, 0.5224, 3.458, 0.0072, 0.0001, 0.618, 0.0046, 0.0744, 0.0001},
	{0.366, 0.0694, 0.1257, 0.4684, 0.4017, 0.2338, 0.1558, 1.0616, 0.0076, 0.002, 0.1283, 0.5287, 0.2074, 0.3248, 0.1239, 0.1464, 0, 0.5261, 0.5091, 0.7618, 0.0603, 0.1558, 0.3914, 0.0105, 0.1034, 0.0121},
	{0.0053, 0.0092, 0.0002, 0.0133, 0.0192, 0.0053, 0.0024, 0.0019, 0.0024, 0, 0.0007, 0.0022, 0.0013, 0.0094, 0.0067, 0.0012, 0, 0.0058, 0.0115, 0.0064, 0.0003, 0, 0.0009, 0, 0.0077, 0},
	{0.1134, 0.0007, 0.2211, 0.009, 0.0317, 0.0018, 0.0014, 0.0016, 0.0927, 0, 0.0015, 0.0284, 0.0007, 0.0742, 0.1034, 0.0021, 0, 0.0733, 0.06, 0.0109, 0.009, 0.0001, 0.0042, 0, 0.0071, 0},
	{0.8846, 0.2044, 0.0849, 0.1193, 0.579, 0.104, 0.1005, 0.0215, 0.4047, 0, 0.0253, 0.6463, 0.0117, 0.1115, 0.2785, 0.1357, 0, 0.0947, 0.1448, 0.1942, 0.2724, 0, 0.028, 0.0004, 0.0454, 0.0021},
	{0.2314, 0.0041, 0.0021, 0.096, 0.4551, 0.0316, 0.0292, 0.0315, 0.3092, 0, 0.0079, 0.0705, 0.0688, 0.0571, 0.4763, 0.0118, 0, 0.1612, 0.1448, 0.0919, 0.0972, 0, 0.0107, 0.0021, 0.057, 0.0001},
	{1.6043, 0.003, 0.001, 0.0923, 1.031, 0.0109, 0.0547, 0.0182, 2.0922, 0, 0.0658, 0.0215, 0.0203, 0.0825, 0.9899, 0.0026, 0, 0.15, 0.1094, 0.0646, 0.3448, 0.0005, 0.1139, 0.0001, 0.0263, 0},
	{0.0089, 0.2594, 0.3901, 0.3081, 0.3042, 0.3775, 0.2045, 0.5198, 0.2249, 0.034, 0.0294, 0.4147, 0.3351, 0.5622, 0.3206, 0.2769, 0, 0.5798, 0.6479, 0.9578, 0.0348, 0.0532, 0.1951, 0.0015, 0.2335, 0.008},
	{0.2167, 0.001, 0.0026, 0.0542, 0.2784, 0.016, 0.0196, 0.014, 0.1256, 0, 0.0049, 0.0316, 0.1221, 0.0451, 0.1327, 0.0876, 0, 0.1021, 0.2621, 0.0548, 0.1641, 0, 0.0055, 0.0191, 0.053, 0},
	{0.0044, 0.0003, 0.0018, 0.0096, 0.0768, 0.0029, 0.0027, 0.0019, 0.0046, 0, 0.0007, 0.0015, 0.0015, 0.0124, 0.0052, 0.0007, 0, 0.0063, 0.0199, 0.0055, 0.0006, 0, 0.0013, 0.0001, 0.0042, 0},
	{0.8429, 0.1007, 0.1416, 0.1271, 1.6615, 0.1765, 0.138, 0.0928, 0.268, 0.0002, 0.0044, 0.0234, 0.0134, 0.0315, 0.8547, 0.1877, 0, 0.1065, 0.0447, 0.2535, 0.332, 0.0004, 0.0245, 0, 0.042, 0},
	{0.8312, 0.0523, 0.0091, 0.328, 1.3958, 0.0572, 0.1307, 0.0615, 0.9275, 0, 0.0861, 0.15, 0.0947, 0.3908, 0.3132, 0.0696, 0, 0.3775, 0.4539, 0.422, 0.3444, 0.0001, 0.0607, 0.0007, 0.1878, 0.0002},
	{1.1171, 0.0231, 0.1301, 0.4049, 0.8241, 0.3955, 0.1979, 0.322, 0.851, 0.0001, 0.0416, 0.1622, 0.1087, 1.0385, 0.5089, 0.1314, 0, 0.4526, 1.3206, 0.5265, 0.4458, 0.0006, 0.0469, 0.0229, 0.1773, 0.0001},
	{0.0611, 0.2814, 0.0962, 0.0839, 0.0561, 0.0864, 0.0638, 0.0941, 0.0055, 0.0284, 0.0078, 0.0854, 0.095, 0.0532, 0.8933, 0.0648, 0.1649, 0.1032, 0.2358, 0.221, 0.0012, 0.0019, 0.0049, 0.0009, 0.0147, 0.0007},
	{0.1904, 0.0015, 0.0007, 0.0223, 0.2484, 0.0056, 0.0083, 0.003, 0.1439, 0, 0.0012, 0.0267, 0.0011, 0.0389, 0.1159, 0.0003, 0, 0.0433, 0.0199, 0.0145, 0.0031, 0, 0.0016, 0.0002, 0.009, 0},
	{0.1225, 0.0094, 0.0036, 0.1686, 0.4532, 0.0368, 0.0495, 0.0434, 0.0253, 0, 0.0226, 0.0488, 0.0471, 0.1128, 0.4735, 0.0171, 0, 0.0897, 0.2388, 0.2516, 0.0157, 0, 0.0176, 0.0009, 0.0789, 0},
	{0.0033, 0, 0, 0.0002, 0.0805, 0.0001, 0, 0, 0.0137, 0, 0, 0, 0, 0.0034, 0.0046, 0, 0, 0.0002, 0.0002, 0, 0.0011, 0, 0, 0.0002, 0, 0},
	{0.2258, 0.1451, 0.016, 0.0688, 0.1775, 0.0187, 0.0128, 0.05, 0.0004, 0, 0.0206, 0.4064, 0.0849, 0.0941, 0.0559, 0.0079, 0, 0.1858, 0.0459, 0.127, 0.0025, 0.0051, 0.0065, 0.0009, 0.0133, 0.0026},
	{0.0199, 0, 0.001, 0.0001, 0.0071, 0.0002, 0.0001, 0, 0.0245, 0, 0, 0.0004, 0, 0.0011, 0.0034, 0, 0, 0.0005, 0.0004, 0.0007, 0.0018, 0, 0.0007, 0, 0.0002, 0.0045},
}

// The letters are sorted by frequency
var BiGramFactMatrixByFrequency = [26][26]float64{
	{0.5799, 0.7977, 0.0041, 0.0563, 0.2125, 0.5996, 0.7583, 1.2604, 2.7966, 0.8904, 0.5668, 0.3592, 0.1326, 0.6149, 0.1584, 0.3662, 0.2487, 0.2889, 0.2046, 0.4292, 0.603, 0.293, 0.0123, 0.0255, 0, 0.0301},
	{0.8241, 0.5265, 1.1171, 0.5089, 0.851, 1.0385, 1.3206, 0.4526, 0.322, 0.1622, 0.4049, 0.1301, 0.4458, 0.1087, 0.3955, 0.1314, 0.1979, 0.0469, 0.1773, 0.0231, 0.0006, 0.0416, 0.0229, 0.0001, 0, 0.0001},
	{1.0646, 0.6301, 0.0126, 0.2048, 0.12, 0.3972, 0.6233, 0.5002, 1.3277, 0.4476, 0.4027, 0.3384, 0.0646, 0.4804, 0.2161, 0.2239, 0.2412, 0.4431, 0.1598, 0.1124, 0.0787, 0.0444, 0.0111, 0.0231, 0.0001, 0.0052},
	{0.3042, 0.9578, 0.0089, 0.3206, 0.2249, 0.5622, 0.6479, 0.5798, 0.5198, 0.4147, 0.3081, 0.3901, 0.0348, 0.3351, 0.3775, 0.2769, 0.2045, 0.1951, 0.2335, 0.2594, 0.0532, 0.0294, 0.0015, 0.034, 0, 0.008},
	{0.4017, 0.7618, 0.366, 0.1239, 0.0076, 0.3248, 0.5091, 0.5261, 1.0616, 0.5287, 0.4684, 0.1257, 0.0603, 0.2074, 0.2338, 0.1464, 0.1558, 0.3914, 0.1034, 0.0694, 0.1558, 0.1283, 0.0105, 0.002, 0, 0.0121},
	{1.031, 0.0646, 1.6043, 0.9899, 2.0922, 0.0825, 0.1094, 0.15, 0.0182, 0.0215, 0.0923, 0.001, 0.3448, 0.0203, 0.0109, 0.0026, 0.0547, 0.1139, 0.0263, 0.003, 0.0005, 0.0658, 0.0001, 0, 0, 0},
	{1.3958, 0.422, 0.8312, 0.3132, 0.9275, 0.3908, 0.4539, 0.3775, 0.0615, 0.15, 0.328, 0.0091, 0.3444, 0.0947, 0.0572, 0.0696, 0.1307, 0.0607, 0.1878, 0.0523, 0.0001, 0.0861, 0.0007, 0, 0, 0.0002},
	{1.6615, 0.2535, 0.8429, 0.8547, 0.268, 0.0315, 0.0447, 0.1065, 0.0928, 0.0234, 0.1271, 0.1416, 0.332, 0.0134, 0.1765, 0.1877, 0.138, 0.0245, 0.042, 0.1007, 0.0004, 0.0044, 0, 0.0002, 0, 0},
	{0.2748, 3.458, 0.1142, 0.0904, 0.0239, 0.1387, 0.5224, 0.0887, 0.0528, 0.0431, 0.1584, 0.3951, 0.0072, 0.0298, 0.0729, 0.0464, 0.3645, 0.618, 0.0744, 0.0069, 0.0001, 0.0174, 0.0046, 0, 0, 0.0001},
	{0.579, 0.1942, 0.8846, 0.2785, 0.4047, 0.1115, 0.1448, 0.0947, 0.0215, 0.6463, 0.1193, 0.0849, 0.2724, 0.0117, 0.104, 0.1357, 0.1005, 0.028, 0.0454, 0.2044, 0, 0.0253, 0.0004, 0, 0, 0.0021},
	{1.1071, 0.0589, 0.3573, 0.1881, 0.2496, 1.1867, 0.0637, 0.2238, 0.0131, 0.2733, 0.1062, 0.002, 0.0656, 0.0071, 0.0165, 0.0056, 0.0192, 0.0133, 0.0574, 0.0048, 0, 0.0057, 0.0002, 0, 0, 0.0002},
	{0.4329, 0.1111, 0.3092, 0.1116, 0.3049, 0.2972, 0.1931, 0.1117, 0.0177, 0.0353, 0.0802, 0.0386, 0.1571, 0.0089, 0.0226, 0.0059, 0.0237, 0.0138, 0.0634, 0.0033, 0, 0.0068, 0.0175, 0, 0, 0},
	{0.0561, 0.221, 0.0611, 0.8933, 0.0055, 0.0532, 0.2358, 0.1032, 0.0941, 0.0854, 0.0839, 0.0962, 0.0012, 0.095, 0.0864, 0.0648, 0.0638, 0.0049, 0.0147, 0.2814, 0.0019, 0.0078, 0.0009, 0.0284, 0.1649, 0.0007},
	{0.4551, 0.0919, 0.2314, 0.4763, 0.3092, 0.0571, 0.1448, 0.1612, 0.0315, 0.0705, 0.096, 0.0021, 0.0972, 0.0688, 0.0316, 0.0118, 0.0292, 0.0107, 0.057, 0.0041, 0, 0.0079, 0.0021, 0, 0, 0.0001},
	{0.2899, 0.0855, 0.1016, 0.7934, 0.1449, 0.0804, 0.1208, 0.0605, 0.0192, 0.0945, 0.1171, 0.0015, 0.019, 0.0193, 0.1047, 0.009, 0.0378, 0.0149, 0.0586, 0.0029, 0, 0.012, 0.0009, 0, 0, 0.0001},
	{0.2784, 0.0548, 0.2167, 0.1327, 0.1256, 0.0451, 0.2621, 0.1021, 0.014, 0.0316, 0.0542, 0.0026, 0.1641, 0.1221, 0.016, 0.0876, 0.0196, 0.0055, 0.053, 0.001, 0, 0.0049, 0.0191, 0, 0, 0},
	{0.1931, 0.032, 0.1812, 0.0532, 0.2402, 1.0748, 0.0435, 0.0589, 0.0077, 0.0149, 0.0467, 0.0017, 0.1443, 0.0044, 0.0128, 0.002, 0.0452, 0.004, 0.0244, 0.0015, 0, 0.0036, 0.0001, 0, 0, 0},
	{0.4532, 0.2516, 0.1225, 0.4735, 0.0253, 0.1128, 0.2388, 0.0897, 0.0434, 0.0488, 0.1686, 0.0036, 0.0157, 0.0471, 0.0368, 0.0171, 0.0495, 0.0176, 0.0789, 0.0094, 0, 0.0226, 0.0009, 0, 0, 0},
	{0.1775, 0.127, 0.2258, 0.0559, 0.0004, 0.0941, 0.0459, 0.1858, 0.05, 0.4064, 0.0688, 0.016, 0.0025, 0.0849, 0.0187, 0.0079, 0.0128, 0.0065, 0.0133, 0.1451, 0.0051, 0.0206, 0.0009, 0, 0, 0.0026},
	{0.2658, 0.1127, 0.2441, 0.1234, 0.0621, 0.0818, 0.15, 0.1051, 0.0293, 0.0459, 0.1732, 0.0021, 0.0843, 0.0692, 0.0238, 0.0099, 0.0378, 0.017, 0.0713, 0.0483, 0, 0.0166, 0.0003, 0, 0, 0.0004},
	{0.2484, 0.0145, 0.1904, 0.1159, 0.1439, 0.0389, 0.0199, 0.0433, 0.003, 0.0267, 0.0223, 0.0007, 0.0031, 0.0011, 0.0056, 0.0003, 0.0083, 0.0016, 0.009, 0.0015, 0, 0.0012, 0.0002, 0, 0, 0},
	{0.0317, 0.0109, 0.1134, 0.1034, 0.0927, 0.0742, 0.06, 0.0733, 0.0016, 0.0284, 0.009, 0.2211, 0.009, 0.0007, 0.0018, 0.0021, 0.0014, 0.0042, 0.0071, 0.0007, 0.0001, 0.0015, 0, 0, 0, 0},
	{0.0805, 0, 0.0033, 0.0046, 0.0137, 0.0034, 0.0002, 0.0002, 0, 0, 0.0002, 0, 0.0011, 0, 0.0001, 0, 0, 0, 0, 0, 0, 0, 0.0002, 0, 0, 0},
	{0.0192, 0.0064, 0.0053, 0.0067, 0.0024, 0.0094, 0.0115, 0.0058, 0.0019, 0.0022, 0.0133, 0.0002, 0.0003, 0.0013, 0.0053, 0.0012, 0.0024, 0.0009, 0.0077, 0.0092, 0, 0.0007, 0, 0, 0, 0},
	{0.0768, 0.0055, 0.0044, 0.0052, 0.0046, 0.0124, 0.0199, 0.0063, 0.0019, 0.0015, 0.0096, 0.0018, 0.0006, 0.0015, 0.0029, 0.0007, 0.0027, 0.0013, 0.0042, 0.0003, 0, 0.0007, 0.0001, 0, 0, 0},
	{0.0071, 0.0007, 0.0199, 0.0034, 0.0245, 0.0011, 0.0004, 0.0005, 0, 0.0004, 0.0001, 0.001, 0.0018, 0, 0.0002, 0, 0.0001, 0.0007, 0.0002, 0, 0, 0, 0, 0, 0, 0.0045},
}

// ConvertAlphabetOrderToFrequencyOrder converts biGram in alphabet order to frequency order
func ConvertAlphabetOrderToFrequencyOrder(alphabetOrder [26][26]float64) [26][26]float64 {
	matrix := [26][26]float64{}
	for r := range alphabetOrder {
		rIndex := FindIndex(byte(r + 'A'))
		for c := range alphabetOrder[r] {
			// find index
			cIndex := FindIndex(byte(c + 'A'))
			matrix[rIndex][cIndex] = alphabetOrder[r][c]
		}
	}
	return matrix
}

// TabulateMatrix prints matrix in a table format
func TabulateMatrix(matrix [26][26]float64, byFrequency bool){
	fmt.Printf("|%6s", " ")
	if byFrequency{
		for _, v := range LetterFrequencyFactArray{
			fmt.Printf("|%3s%3s", string(v.letter), " ")
		}
	}else{
		for i := 'A'; i <= 'Z'; i++ {
			fmt.Printf("|%3s%3s", string(i), " ")
		}
	}
	fmt.Printf("|\n")

	for index, r := range matrix {
		if byFrequency{
			fmt.Printf("|%3s%3s", string(LetterFrequencyFactArray[index].letter), " ")
		}else{
			fmt.Printf("|%3s%3s", string(index+'A'), " ")
		}
		for _, v := range r {
			fmt.Printf("|%.4f", v)
		}
		fmt.Printf("|\n")
	}
}

// GetLetterFrequencies gets letter frequencies and sort letters by their frequencies
func GetLetterFrequencies(s string) []LetterFrequency {
	frequencyArray := make([]LetterFrequency, 26)
	// initialize letters
	for i := 0; i < len(frequencyArray); i++ {
		frequencyArray[i].letter = byte(i + 'A')
	}

	for i := 0; i < len(s); i++ {
		c := s[i]
		frequencyArray[c-'A'].frequency++
	}

	// sort by frequency
	sort.SliceStable(frequencyArray, func(i, j int) bool {
		return frequencyArray[i].frequency > frequencyArray[j].frequency
	})
	return frequencyArray
}

// TabulateLetterFrequency formats the output of letter frequency
func TabulateLetterFrequency(lf []LetterFrequency){
	for _, v := range lf{
		fmt.Printf("%v:%v,", string(v.letter), v.frequency)
	}
	fmt.Println()
}

// parseText parses text into a biGram
func parseText(s string) [26][26]float64 {
	biGramCountMatrix := [26][26]int{}
	for i := 0; i < len(s)-1; i++ {
		t1, t2 := s[i], s[i+1]
		biGramCountMatrix[t2-'A'][t1-'A']++
	}
	biGramPercentageMatrix := [26][26]float64{}
	for i := 0; i < 26; i++ {
		for j := 0; j < 26; j++ {
			f := float64(biGramCountMatrix[i][j]) / float64(len(s)-1)
			biGramPercentageMatrix[i][j] = math.Round(f*1000000) / 10000
		}
	}
	return biGramPercentageMatrix
}